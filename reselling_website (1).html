<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Rahul Store – Online Shopping</title>
  <style>
    :root{--primary:#2874f0;--accent:#fb641b}
    body { margin:0; font-family: Arial, sans-serif; background:#f1f3f6; color:#111 }

    /* HEADER */
    header { background:var(--primary); padding:12px 20px; color:white; display:flex; gap:12px; align-items:center; }
    header .logo { font-size:22px; font-weight:700; }
    header .search { flex:1 }
    header input[type="search"]{ width:100%; padding:10px; border:none; border-radius:4px; }
    header button{ background:#ff9f00; padding:10px 14px; border:none; border-radius:4px; font-weight:700; cursor:pointer }

    /* CATEGORY BAR */
    .categories { background:white; padding:10px; display:flex; gap:14px; justify-content:center; font-size:15px; box-shadow:0 1px 0 rgba(0,0,0,0.04)}
    .categories div{ padding:6px 10px; border-radius:6px; }
    .categories div:hover { color:var(--primary); cursor:pointer; background:rgba(40,116,240,0.05) }

    /* LAYOUT */
    .container { max-width:1200px; margin:18px auto; padding:0 16px; }
    h2 { margin:0 0 12px 0 }

    /* PRODUCT GRID */
    .products { display:grid; grid-template-columns:repeat(auto-fit, minmax(220px,1fr)); gap:18px; }
    .card { background:white; padding:12px; border-radius:8px; box-shadow:0 3px 8px rgba(0,0,0,0.06); text-align:center; }
    .card img, .card video { width:100%; height:220px; object-fit:cover; border-radius:8px; }
    .title { margin-top:8px; font-size:15px; font-weight:600; }
    .price { color:#388e3c; font-size:17px; font-weight:700; margin-top:6px }
    .btn { background:var(--accent); color:white; padding:10px; border:none; border-radius:6px; width:100%; margin-top:10px; font-size:15px; cursor:pointer }

    /* POPUP */
    #popup { position:fixed; top:0; left:0; right:0; bottom:0; background:rgba(0,0,0,0.45); display:none; justify-content:center; align-items:center; z-index:40 }
    #formBox { background:white; padding:18px; width:92%; max-width:420px; border-radius:10px; box-shadow:0 8px 30px rgba(2,6,23,0.2) }
    #formBox input, #formBox textarea { width:100%; padding:10px; margin:8px 0; border-radius:6px; border:1px solid #ddd }

    /* ADMIN PANEL */
    .admin { margin-top:24px; background:#fff; padding:12px; border-radius:8px; box-shadow:0 4px 14px rgba(0,0,0,0.04) }
    .admin form{ display:grid; gap:8px }
    .admin input[type="text"]{ padding:8px; border:1px solid #ddd; border-radius:6px }
    .admin .row{ display:flex; gap:8px }
    .small{ flex:1 }

    footer{ text-align:center; color:#666; padding:18px 0; margin-top:24px }

    @media(max-width:700px){ header{ flex-direction:column; align-items:stretch } }
  </style>
</head>
<body>

<header>
  <div class="logo">Rahul Store</div>
  <div class="search"><input type="search" id="searchInput" placeholder="Search for products..." oninput="applySearch()" /></div>
  <button onclick="toggleAdmin()" id="adminToggle">Admin</button>
</header>

<div class="categories">
  <div onclick="filterCategory('All')">All</div>
  <div onclick="filterCategory('Men')">Men</div>
  <div onclick="filterCategory('Women')">Women</div>
  <div onclick="filterCategory('Kids')">Kids</div>
  <div onclick="filterCategory('Footwear')">Footwear</div>
  <div onclick="filterCategory('Accessories')">Accessories</div>
</div>

<div class="container">
  <h2>Featured Products</h2>
  <div id="productList" class="products"></div>

  <!-- POPUP -->
  <div id="popup">
    <div id="formBox">
      <h3>Place Your Order</h3>
      <p id="itemName"></p>
      <input type="text" id="custName" placeholder="Your Name" />
      <input type="text" id="custAddress" placeholder="Your Address" />
      <input type="text" id="custPhone" placeholder="Phone Number" />
      <div style="display:flex;gap:8px;margin-top:8px">
        <button class="btn" onclick="submitOrder()">Submit Order</button>
        <button class="btn" style="background:#999" onclick="closePopup()">Cancel</button>
      </div>
    </div>
  </div>

  <!-- ADMIN PANEL (hidden by default) -->
  <div id="adminPanel" class="admin" style="display:none;margin-top:18px">
    <h3>Admin Panel — Add Product</h3>
    <form id="adminForm">
      <input type="text" id="pName" placeholder="Product Name (required)" required />
      <div class="row">
        <input type="text" id="pPrice" placeholder="Price (e.g., 499)" class="small" required />
        <input type="text" id="pCategory" placeholder="Category (Men/Women/All)" class="small" />
      </div>
      <input type="text" id="pImg" placeholder="Image URL (required)" required />
      <input type="text" id="pVideo" placeholder="Video URL (optional)" />
      <input type="text" id="pDesc" placeholder="Short Description (optional)" />
      <div style="display:flex;gap:8px;margin-top:8px">
        <button type="submit" class="btn">Add Product</button>
        <button type="button" class="btn" style="background:#6b7280" onclick="clearProducts()">Clear All</button>
      </div>
    </form>
    <p style="margin-top:10px;color:#555">Products are saved in your browser (localStorage). To make them available on other devices, you can copy & paste the product JSON from the console or we can integrate server storage later.</p>
  </div>
</div>

<footer>© <span id="year"></span> Rahul Store — Built for reselling</footer>

<script>
  // Utilities
  document.getElementById('year').textContent = new Date().getFullYear();

  function toggleAdmin(){
    const el = document.getElementById('adminPanel');
    el.style.display = (el.style.display === 'none' || el.style.display === '') ? 'block' : 'none';
    document.getElementById('adminToggle').textContent = el.style.display === 'block' ? 'Close Admin' : 'Admin';
  }

  // Initial sample products (will be merged with saved products)
  const sampleProducts = [
    { id: genId(), name: 'Oversize Black T-Shirt', price: 499, img: 'https://via.placeholder.com/400x500?text=T-Shirt', category: 'Men', desc: 'Comfort fit' },
    { id: genId(), name: 'Premium Denim Jacket', price: 999, img: 'https://via.placeholder.com/400x500?text=Denim+Jacket', category: 'Men', desc: 'Stylish and warm' },
    { id: genId(), name: 'Trendy Cargo Pants', price: 799, img: 'https://via.placeholder.com/400x500?text=Cargo+Pants', category: 'Men', desc: 'Casual wear' },
    { id: genId(), name: 'Hoodie Winter Edition', price: 899, img: 'https://via.placeholder.com/400x500?text=Hoodie', category: 'All', desc: 'Soft fleece' }
  ];

  // In-memory products array will be loaded from localStorage + samples
  let products = [];

  function genId(){ return 'p_' + Math.random().toString(36).slice(2,9); }

  // Load products from localStorage and merge with sampleItems if storage empty
  function loadStoredProducts(){
    try{
      const stored = JSON.parse(localStorage.getItem('rs_products') || '[]');
      if(stored.length) products = stored;
      else products = sampleProducts.slice();
    }catch(e){ console.error('Failed to load products', e); products = sampleProducts.slice(); }
  }

  function saveProducts(){ localStorage.setItem('rs_products', JSON.stringify(products)); }

  // Render products into #productList, optionally filtered
  function renderProducts(list){
    const container = document.getElementById('productList');
    if(!list) list = products;
    if(list.length === 0){ container.innerHTML = '<div style="grid-column:1/-1;padding:20px;background:#fff;border-radius:8px;text-align:center">No products found.</div>'; return }

    let html = '';
    list.forEach(p => {
      const image = p.img ? `<img src="${escapeHtml(p.img)}" alt="${escapeHtml(p.name)}" />` : '';
      const price = typeof p.price === 'number' ? '₹' + p.price : (p.price || '₹0');
      html += `\n        <div class="card">\n          ${image}\n          <div class="title">${escapeHtml(p.name)}</div>\n          <div class="price">${price}</div>\n          <div style=\"margin-top:8px;color:#555;font-size:13px\">${escapeHtml(p.desc || '')}</div>\n          <button class=\"btn\" onclick=\"orderNow('${p.id}')\">Order Now</button>\n        </div>`;
    });
    container.innerHTML = html;
  }

  // Simple search / filter
  function applySearch(){ const q = (document.getElementById('searchInput').value || '').toLowerCase(); renderProducts(products.filter(p => p.name.toLowerCase().includes(q) || (p.desc||'').toLowerCase().includes(q))); }
  function filterCategory(cat){ if(cat === 'All') renderProducts(products); else renderProducts(products.filter(p => (p.category||'All') === cat || (p.category||'All') === 'All')); }

  // Order flow
  let currentOrderProduct = null;
  function orderNow(productId){
    currentOrderProduct = products.find(p => p.id === productId) || null;
    document.getElementById('itemName').innerText = currentOrderProduct ? (currentOrderProduct.name + ' — ₹' + currentOrderProduct.price) : '';
    document.getElementById('custName').value = '';
    document.getElementById('custAddress').value = '';
    document.getElementById('custPhone').value = '';
    document.getElementById('popup').style.display = 'flex';
  }
  function closePopup(){ document.getElementById('popup').style.display = 'none'; }

  function submitOrder(){
    const name = document.getElementById('custName').value.trim();
    const address = document.getElementById('custAddress').value.trim();
    const phone = document.getElementById('custPhone').value.trim();
    if(!name || !address || !phone){ alert('Please fill all details'); return }

    // Show confirmation (fixed newline escaping)
    alert('Order Confirmed!\n' + (currentOrderProduct ? (currentOrderProduct.name + ' — ₹' + currentOrderProduct.price) : '') + '\nName: ' + name + '\nPhone: ' + phone + '\nAddress: ' + address);
    // In a real app you would send this to a server or WhatsApp API
    closePopup();
  }

  // Admin: Add product
  const adminForm = document.getElementById('adminForm');
  adminForm.addEventListener('submit', function(e){
    e.preventDefault();
    const name = document.getElementById('pName').value.trim();
    const priceRaw = document.getElementById('pPrice').value.trim();
    const img = document.getElementById('pImg').value.trim();
    const video = document.getElementById('pVideo').value.trim();
    const desc = document.getElementById('pDesc').value.trim();
    const category = document.getElementById('pCategory').value.trim() || 'All';
    if(!name || !priceRaw || !img) { alert('Please fill required fields: name, price, image'); return }
    const price = Number(priceRaw.replace(/[^0-9.]/g, '')) || 0;
    const product = { id: genId(), name, price, img, video, desc, category };
    products.unshift(product); // add to front
    saveProducts();
    renderProducts(products);
    adminForm.reset();
    alert('Product Added Successfully!');
  });

  function clearProducts(){ if(confirm('Clear all products from browser storage?')){ products = sampleProducts.slice(); saveProducts(); renderProducts(products); alert('Products cleared and reset to samples.'); }}

  // Escape helper to avoid breaking HTML when inserting strings
  function escapeHtml(str){ if(!str && str !== 0) return ''; return String(str).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;').replace(/'/g,'&#039;'); }

  // Init
  loadStoredProducts();
  renderProducts(products);

  // Expose some functions for console debugging
  window.rs = { products, renderProducts, saveProducts, loadStoredProducts };
</script>

</body>
</html>
